# -*- coding: utf-8 -*-
"""Practical 3.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1nZPOGRIgLGWsns6f2wxJts6VP1YLZqPI
"""

pip install geemap

pip install geemap[all]

pip install geemap[lidar]

pip install geemap[raster]

pip install geemap[sql]

pip install geemap[vector]

pip install geemap[streamlit]

import geemap.geemap as map

import ee

ee.Authenticate()

ee.Initialize(project = 'ee-nalinapk17')

m=map.Map()
m

India = ee.FeatureCollection('projects/ee-nalinapk17/assets/India_states')
India

India_Districts = ee.FeatureCollection('projects/ee-nalinapk17/assets/India_Districts')
m.addLayer(India_Districts,{},'India_Districts') #dislpaying the shapefile in the interactive map
m

Hyderabad = India_Districts.filter(ee.Filter.eq('District','HYDERABAD')) #Name,value
m.addLayer(Hyderabad,{},'HYDERABAD')
m

NDVI2024 = ee.ImageCollection("LANDSAT/COMPOSITES/C02/T1_L2_8DAY_NDVI").select('NDVI').filterDate('2024-03-01', '2024-5-31')
HyderabadNDVI_2024 = NDVI2024.mean().clip(Hyderabad)
NDVI = {'min':0, 'max':1, 'palette': ['ffffff', 'ce7e45', 'df923d', 'f1b555', 'fcd163', '99b718', '74a901',
    '66a000', '529400', '3e8601', '207401', '056201', '004c00', '023b01',
    '012e01', '011d01', '011301']}
m.addLayer(HyderabadNDVI_2024, NDVI, 'NDVI_2024')
m

import os

Hyderabad_clipped = HyderabadNDVI_2024.clip(Hyderabad.geometry())
out_dir = os.path.join(os.path.expanduser('~'), 'Downloads')
filename = os.path.join(out_dir, 'NDVI_2024.tif')
if not os.path.exists(out_dir):
    os.makedirs(out_dir)
map.ee_export_image(
    Hyderabad_clipped,
    filename=filename,
    scale=30,  # Set a reasonable scale (e.g., 30m)
    region=Hyderabad.geometry(),  # Ensure the region is correct
    file_per_band=False
)

NDVI2014 = ee.ImageCollection("LANDSAT/COMPOSITES/C02/T1_L2_8DAY_NDVI").select('NDVI').filterDate('2014-03-01', '2014-5-31')
HyderabadNDVI_2014 = NDVI2014.mean().clip(Hyderabad)
HyderabadNDVI_2014 = HyderabadNDVI_2014.updateMask(HyderabadNDVI_2014.gt(0))
NDVI = {'min':0, 'max':1, 'palette': ['ffffff', 'ce7e45', 'df923d', 'f1b555', 'fcd163', '99b718', '74a901',
    '66a000', '529400', '3e8601', '207401', '056201', '004c00', '023b01',
    '012e01', '011d01', '011301']}
m.addLayer(HyderabadNDVI_2014, NDVI, 'NDVI_2014')
m

Hyderabad_clipped = HyderabadNDVI_2014.clip(Hyderabad.geometry())
out_dir = os.path.join(os.path.expanduser('~'), 'Downloads')
filename = os.path.join(out_dir, 'NDVI_2014.tif')
if not os.path.exists(out_dir):
    os.makedirs(out_dir)
map.ee_export_image(
    Hyderabad_clipped,
    filename=filename,
    scale=30,  # Set a reasonable scale (e.g., 30m)
    region=Hyderabad.geometry(),  # Ensure the region is correct
    file_per_band=False
)

NDVI2004 = ee.ImageCollection("LANDSAT/COMPOSITES/C02/T1_L2_8DAY_NDVI").select('NDVI').filterDate('2004-03-01', '2004-5-31')
HyderabadNDVI_2004 = NDVI2004.mean().clip(Hyderabad)
HyderabadNDVI_2004 = HyderabadNDVI_2004.updateMask(HyderabadNDVI_2004.gt(0))
NDVI = {'min':0, 'max':1, 'palette': ['ffffff', 'ce7e45', 'df923d', 'f1b555', 'fcd163', '99b718', '74a901',
    '66a000', '529400', '3e8601', '207401', '056201', '004c00', '023b01',
    '012e01', '011d01', '011301']}
m.addLayer(HyderabadNDVI_2004, NDVI, 'NDVI_2004')
m

Hyderabad_clipped = HyderabadNDVI_2004.clip(Hyderabad.geometry())
out_dir = os.path.join(os.path.expanduser('~'), 'Downloads')
filename = os.path.join(out_dir, 'NDVI_2004.tif')
if not os.path.exists(out_dir):
    os.makedirs(out_dir)
map.ee_export_image(
    Hyderabad_clipped,
    filename=filename,
    scale=30,  # Set a reasonable scale (e.g., 30m)
    region=Hyderabad.geometry(),  # Ensure the region is correct
    file_per_band=False
)

NDVI1994 = ee.ImageCollection("LANDSAT/COMPOSITES/C02/T1_L2_8DAY_NDVI").select('NDVI').filterDate('1994-03-01', '1994-5-31')
HyderabadNDVI_1994 = NDVI1994.mean().clip(Hyderabad)
HyderabadNDVI_1994 = HyderabadNDVI_1994.updateMask(HyderabadNDVI_1994.gt(0))
NDVI = {'min':0, 'max':1, 'palette': ['ffffff', 'ce7e45', 'df923d', 'f1b555', 'fcd163', '99b718', '74a901',
    '66a000', '529400', '3e8601', '207401', '056201', '004c00', '023b01',
    '012e01', '011d01', '011301']}
m.addLayer(HyderabadNDVI_1994, NDVI, 'NDVI_1994')
m

Hyderabad_clipped = HyderabadNDVI_1994.clip(Hyderabad.geometry())
out_dir = os.path.join(os.path.expanduser('~'), 'Downloads')
filename = os.path.join(out_dir, 'NDVI_1994.tif')
if not os.path.exists(out_dir):
    os.makedirs(out_dir)
map.ee_export_image(
    Hyderabad_clipped,
    filename=filename,
    scale=30,  # Set a reasonable scale (e.g., 30m)
    region=Hyderabad.geometry(),  # Ensure the region is correct
    file_per_band=False
)

NDVI1989 = ee.ImageCollection("LANDSAT/COMPOSITES/C02/T1_L2_8DAY_NDVI").select('NDVI').filterDate('1989-03-01', '1989-12-31')
HyderabadNDVI_1989 = NDVI1989.mean().clip(Hyderabad)
NDVI = {'min':0, 'max':1, 'palette': ['ffffff', 'ce7e45', 'df923d', 'f1b555', 'fcd163', '99b718', '74a901',
    '66a000', '529400', '3e8601', '207401', '056201', '004c00', '023b01',
    '012e01', '011d01', '011301']}
m.addLayer(HyderabadNDVI_1989, NDVI, 'NDVI_1989')
m

Hyderabad_clipped = HyderabadNDVI_1989.clip(Hyderabad.geometry())
out_dir = os.path.join(os.path.expanduser('~'), 'Downloads')
filename = os.path.join(out_dir, 'NDVI_1989.tif')
if not os.path.exists(out_dir):
    os.makedirs(out_dir)
map.ee_export_image(
    Hyderabad_clipped,
    filename=filename,
    scale=30,  # Set a reasonable scale (e.g., 30m)
    region=Hyderabad.geometry(),  # Ensure the region is correct
    file_per_band=False
)

def calculate_NDWI(image):
    green = image.select('SR_B3')
    nir = image.select('SR_B5')
    ndwi = green.subtract(nir).divide(green.add(nir)).rename('NDWI')
    return image.addBands(ndwi)
NDWI2024 = (
    ee.ImageCollection("LANDSAT/LC09/C02/T1_L2")
    .filterDate('2024-03-01', '2024-05-31')
    .filterBounds(Hyderabad)
    .map(calculate_NDWI)
)
HyderabadNDWI_2024 = NDWI2024.select('NDWI').mean().clip(Hyderabad)
NDWI_viz = {'min': -1, 'max': 1, 'palette': [
        '#D73027',  # Red (Dry/Built-up)
        '#FC8D59',  # Orange (Barren Land)
        '#FEE08B',  # Yellow (Sparse Vegetation)
        '#D9EF8B',  # Light Green (Moist Soil)
        '#91CF60',  # Green (Vegetation)
        '#1A9850',  # Dark Green (Shallow Water)
        '#313695'   # Blue (Deep Water)
    ]}
m.addLayer(HyderabadNDWI_2024, NDWI_viz, 'NDWI_2024')
m

Hyderabad_clipped = HyderabadNDWI_2024.clip(Hyderabad.geometry())
out_dir = os.path.join(os.path.expanduser('~'), 'Downloads')
filename = os.path.join(out_dir, 'NDWI_2024.tif')
if not os.path.exists(out_dir):
    os.makedirs(out_dir)
map.ee_export_image(
    Hyderabad_clipped,
    filename=filename,
    scale=30,  # Set a reasonable scale (e.g., 30m)
    region=Hyderabad.geometry(),  # Ensure the region is correct
    file_per_band=False
)

def calculate_NDWI(image):
    green = image.select('SR_B3')
    nir = image.select('SR_B5')
    ndwi = green.subtract(nir).divide(green.add(nir)).rename('NDWI')
    return image.addBands(ndwi)
NDWI2014 = (
    ee.ImageCollection("LANDSAT/LC08/C02/T1_L2")
    .filterDate('2014-03-01', '2014-05-31')
    .filterBounds(Hyderabad)
    .map(calculate_NDWI)
)
HyderabadNDWI_2014 = NDWI2014.select('NDWI').mean().clip(Hyderabad)
NDWI_viz = {'min': -1, 'max': 1, 'palette': [
        '#D73027',  # Red (Dry/Built-up)
        '#FC8D59',  # Orange (Barren Land)
        '#FEE08B',  # Yellow (Sparse Vegetation)
        '#D9EF8B',  # Light Green (Moist Soil)
        '#91CF60',  # Green (Vegetation)
        '#1A9850',  # Dark Green (Shallow Water)
        '#313695'   # Blue (Deep Water)
    ]}
m.addLayer(HyderabadNDWI_2014, NDWI_viz, 'NDWI_2014')
m

Hyderabad_clipped = HyderabadNDWI_2014.clip(Hyderabad.geometry())
out_dir = os.path.join(os.path.expanduser('~'), 'Downloads')
filename = os.path.join(out_dir, 'NDWI_2014.tif')
if not os.path.exists(out_dir):
    os.makedirs(out_dir)
map.ee_export_image(
    Hyderabad_clipped,
    filename=filename,
    scale=30,  # Set a reasonable scale (e.g., 30m)
    region=Hyderabad.geometry(),  # Ensure the region is correct
    file_per_band=False
)

def calculate_NDWI(image):
    green = image.select('SR_B2')
    nir = image.select('SR_B4')
    ndwi = green.subtract(nir).divide(green.add(nir)).rename('NDWI')
    return image.addBands(ndwi)
NDWI2004 = (
    ee.ImageCollection("LANDSAT/LT05/C02/T1_L2")
    .filterDate('2004-03-01', '2004-05-31')
    .filterBounds(Hyderabad)
    .map(calculate_NDWI)
)
HyderabadNDWI_2004 = NDWI2004.select('NDWI').mean().clip(Hyderabad)
NDWI_viz = {'min': -1, 'max': 1, 'palette': [
        '#D73027',  # Red (Dry/Built-up)
        '#FC8D59',  # Orange (Barren Land)
        '#FEE08B',  # Yellow (Sparse Vegetation)
        '#D9EF8B',  # Light Green (Moist Soil)
        '#91CF60',  # Green (Vegetation)
        '#1A9850',  # Dark Green (Shallow Water)
        '#313695'   # Blue (Deep Water)
    ]}
m.addLayer(HyderabadNDWI_2004, NDWI_viz, 'NDWI_2004')
m

Hyderabad_clipped = HyderabadNDWI_2004.clip(Hyderabad.geometry())
out_dir = os.path.join(os.path.expanduser('~'), 'Downloads')
filename = os.path.join(out_dir, 'NDWI_2004.tif')
if not os.path.exists(out_dir):
    os.makedirs(out_dir)
map.ee_export_image(
    Hyderabad_clipped,
    filename=filename,
    scale=30,  # Set a reasonable scale (e.g., 30m)
    region=Hyderabad.geometry(),  # Ensure the region is correct
    file_per_band=False
)

def calculate_NDWI(image):
    green = image.select('SR_B2')
    nir = image.select('SR_B4')
    ndwi = green.subtract(nir).divide(green.add(nir)).rename('NDWI')
    return image.addBands(ndwi)
NDWI1994 = (
    ee.ImageCollection("LANDSAT/LT05/C02/T1_L2")
    .filterDate('1994-03-01', '1994-05-31')
    .filterBounds(Hyderabad)
    .map(calculate_NDWI)
)
HyderabadNDWI_1994 = NDWI1994.select('NDWI').mean().clip(Hyderabad)
NDWI_viz = {'min': -1, 'max': 1, 'palette': [
        '#D73027',  # Red (Dry/Built-up)
        '#FC8D59',  # Orange (Barren Land)
        '#FEE08B',  # Yellow (Sparse Vegetation)
        '#D9EF8B',  # Light Green (Moist Soil)
        '#91CF60',  # Green (Vegetation)
        '#1A9850',  # Dark Green (Shallow Water)
        '#313695'   # Blue (Deep Water)
    ]}
m.addLayer(HyderabadNDWI_1994, NDWI_viz, 'NDWI_1994')
m

Hyderabad_clipped = HyderabadNDWI_1994.clip(Hyderabad.geometry())
out_dir = os.path.join(os.path.expanduser('~'), 'Downloads')
filename = os.path.join(out_dir, 'NDWI_1994.tif')
if not os.path.exists(out_dir):
    os.makedirs(out_dir)
map.ee_export_image(
    Hyderabad_clipped,
    filename=filename,
    scale=30,  # Set a reasonable scale (e.g., 30m)
    region=Hyderabad.geometry(),  # Ensure the region is correct
    file_per_band=False
)

def calculate_NDWI(image):
    green = image.select('SR_B2')
    nir = image.select('SR_B4')
    ndwi = green.subtract(nir).divide(green.add(nir)).rename('NDWI')
      # Return the original image with the NDWI band added
    return image.addBands(ndwi)
NDWI1989 = (
    ee.ImageCollection("LANDSAT/LT05/C02/T1_L2")
    .filterDate('1989-04-01', '1989-12-31')
    .filterBounds(Hyderabad)
    .map(calculate_NDWI)
)
HyderabadNDWI_1989 = NDWI1989.select('NDWI').mean().clip(Hyderabad)
NDWI_viz = {'min': -1, 'max': 1, 'palette': [
        '#D73027',  # Red (Dry/Built-up)
        '#FC8D59',  # Orange (Barren Land)
        '#FEE08B',  # Yellow (Sparse Vegetation)
        '#D9EF8B',  # Light Green (Moist Soil)
        '#91CF60',  # Green (Vegetation)
        '#1A9850',  # Dark Green (Shallow Water)
        '#313695'   # Blue (Deep Water)
    ]}
m.addLayer(HyderabadNDWI_1989, NDWI_viz, 'NDWI_1989')
m

Hyderabad_clipped = HyderabadNDWI_1989.clip(Hyderabad.geometry())
out_dir = os.path.join(os.path.expanduser('~'), 'Downloads')
filename = os.path.join(out_dir, 'NDWI_1989.tif')
if not os.path.exists(out_dir):
    os.makedirs(out_dir)
map.ee_export_image(
    Hyderabad_clipped,
    filename=filename,
    scale=30,  # Set a reasonable scale (e.g., 30m)
    region=Hyderabad.geometry(),  # Ensure the region is correct
    file_per_band=False
)

def calculate_SAVI(image):
    nir = image.select('SR_B5')  # Near-infrared band for Landsat 8
    red = image.select('SR_B4')  # Red band for Landsat 8
    L = 0.5  # Soil brightness correction factor (typically 0.5)

    savi = nir.subtract(red).multiply(1 + L).divide(nir.add(red).add(L)).rename('SAVI')

    # Return the original image with the SAVI band added
    return image.addBands(savi)

SAVI2024 = (
    ee.ImageCollection("LANDSAT/LC08/C02/T1_L2")
    .filterDate('2024-03-01', '2024-05-31')
    .filterBounds(Hyderabad)
    .map(calculate_SAVI)
)

HyderabadSAVI_2024 = SAVI2024.select('SAVI').mean().clip(Hyderabad)

SAVI_viz = {
    'min': -1,  # Lower bound for SAVI values
    'max': 1,   # Upper bound for SAVI values
    'palette': [
        'brown',    # Barren land / soil
        'yellow',   # Sparse vegetation
        'lightgreen', # Moderate vegetation
        'green',    # Dense vegetation
        'darkgreen' # Very dense vegetation
    ]
}

m.addLayer(HyderabadSAVI_2024, SAVI_viz, 'SAVI_2024')
m

Hyderabad_clipped = HyderabadSAVI_2024.clip(Hyderabad.geometry())
out_dir = os.path.join(os.path.expanduser('~'), 'Downloads')
filename = os.path.join(out_dir, 'SAVI_2024.tif')
if not os.path.exists(out_dir):
    os.makedirs(out_dir)
map.ee_export_image(
    Hyderabad_clipped,
    filename=filename,
    scale=30,  # Set a reasonable scale (e.g., 30m)
    region=Hyderabad.geometry(),  # Ensure the region is correct
    file_per_band=False
)

def calculate_SAVI(image):
    nir = image.select('SR_B5')  # Near-infrared band for Landsat 8
    red = image.select('SR_B4')  # Red band for Landsat 8
    L = 0.5  # Soil brightness correction factor (typically 0.5)

    savi = nir.subtract(red).multiply(1 + L).divide(nir.add(red).add(L)).rename('SAVI')

    # Return the original image with the SAVI band added
    return image.addBands(savi)

SAVI2014 = (
    ee.ImageCollection("LANDSAT/LC08/C02/T1_L2")
    .filterDate('2014-03-01', '2014-05-31')
    .filterBounds(Hyderabad)
    .map(calculate_SAVI)
)

HyderabadSAVI_2014 = SAVI2014.select('SAVI').mean().clip(Hyderabad)

SAVI_viz = {
    'min': -1,  # Lower bound for SAVI values
    'max': 1,   # Upper bound for SAVI values
    'palette': [
        'brown',    # Barren land / soil
        'yellow',   # Sparse vegetation
        'lightgreen', # Moderate vegetation
        'green',    # Dense vegetation
        'darkgreen' # Very dense vegetation
    ]
}

m.addLayer(HyderabadSAVI_2014, SAVI_viz, 'SAVI_2014')
m

Hyderabad_clipped = HyderabadSAVI_2014.clip(Hyderabad.geometry())
out_dir = os.path.join(os.path.expanduser('~'), 'Downloads')
filename = os.path.join(out_dir, 'SAVI_2014.tif')
if not os.path.exists(out_dir):
    os.makedirs(out_dir)
map.ee_export_image(
    Hyderabad_clipped,
    filename=filename,
    scale=30,  # Set a reasonable scale (e.g., 30m)
    region=Hyderabad.geometry(),  # Ensure the region is correct
    file_per_band=False
)

def calculate_SAVI(image):
    nir = image.select('SR_B4')  # Near-infrared band
    red = image.select('SR_B3')  # Red band
    L = 0.5  # Soil brightness correction factor (typical value is 0.5)

    savi = nir.subtract(red).multiply(1 + L).divide(nir.add(red).add(L)).rename('SAVI')

    # Return the original image with the SAVI band added
    return image.addBands(savi)

SAVI2004 = (
    ee.ImageCollection("LANDSAT/LT05/C02/T1_L2")
    .filterDate('2004-03-01', '2004-05-31')
    .filterBounds(Hyderabad)
    .map(calculate_SAVI)
)

HyderabadSAVI_2004 = SAVI2004.select('SAVI').mean().clip(Hyderabad)

SAVI_viz = {
    'min': -1,  # Lower bound for SAVI values
    'max': 1,   # Upper bound for SAVI values
    'palette': [
        'brown',    # Barren land / soil
        'yellow',   # Sparse vegetation
        'lightgreen', # Moderate vegetation
        'green',    # Dense vegetation
        'darkgreen' # Very dense vegetation
    ]
}

m.addLayer(HyderabadSAVI_2004, SAVI_viz, 'SAVI_2004')
m

Hyderabad_clipped = HyderabadSAVI_2004.clip(Hyderabad.geometry())
out_dir = os.path.join(os.path.expanduser('~'), 'Downloads')
filename = os.path.join(out_dir, 'SAVI_2004.tif')
if not os.path.exists(out_dir):
    os.makedirs(out_dir)
map.ee_export_image(
    Hyderabad_clipped,
    filename=filename,
    scale=30,  # Set a reasonable scale (e.g., 30m)
    region=Hyderabad.geometry(),  # Ensure the region is correct
    file_per_band=False
)

def calculate_SAVI(image):
    nir = image.select('SR_B4')  # Near-infrared band
    red = image.select('SR_B3')  # Red band
    L = 0.5  # Soil brightness correction factor (typical value is 0.5)

    savi = nir.subtract(red).multiply(1 + L).divide(nir.add(red).add(L)).rename('SAVI')

    # Return the original image with the SAVI band added
    return image.addBands(savi)

SAVI1994 = (
    ee.ImageCollection("LANDSAT/LT05/C02/T1_L2")
    .filterDate('1994-03-01', '1994-05-31')
    .filterBounds(Hyderabad)
    .map(calculate_SAVI)
)

HyderabadSAVI_1994 = SAVI1994.select('SAVI').mean().clip(Hyderabad)

SAVI_viz = {
    'min': -1,  # Lower bound for SAVI values
    'max': 1,   # Upper bound for SAVI values
    'palette': [
        'brown',    # Barren land / soil
        'yellow',   # Sparse vegetation
        'lightgreen', # Moderate vegetation
        'green',    # Dense vegetation
        'darkgreen' # Very dense vegetation
    ]
}

m.addLayer(HyderabadSAVI_1994, SAVI_viz, 'SAVI_1994')
m

Hyderabad_clipped = HyderabadSAVI_1994.clip(Hyderabad.geometry())
out_dir = os.path.join(os.path.expanduser('~'), 'Downloads')
filename = os.path.join(out_dir, 'SAVI_1994.tif')
if not os.path.exists(out_dir):
    os.makedirs(out_dir)
map.ee_export_image(
    Hyderabad_clipped,
    filename=filename,
    scale=30,  # Set a reasonable scale (e.g., 30m)
    region=Hyderabad.geometry(),  # Ensure the region is correct
    file_per_band=False
)

def calculate_SAVI(image):
    nir = image.select('SR_B4')  # Near-infrared band
    red = image.select('SR_B3')  # Red band
    L = 0.5  # Soil brightness correction factor (typical value is 0.5)

    savi = nir.subtract(red).multiply(1 + L).divide(nir.add(red).add(L)).rename('SAVI')

    # Return the original image with the SAVI band added
    return image.addBands(savi)

SAVI1989 = (
    ee.ImageCollection("LANDSAT/LT05/C02/T1_L2")
    .filterDate('1989-03-01', '1989-12-31')
    .filterBounds(Hyderabad)
    .map(calculate_SAVI)
)

HyderabadSAVI_1989 = SAVI1989.select('SAVI').mean().clip(Hyderabad)

SAVI_viz = {
    'min': -1,  # Lower bound for SAVI values
    'max': 1,   # Upper bound for SAVI values
    'palette': [
        'brown',    # Barren land / soil
        'yellow',   # Sparse vegetation
        'lightgreen', # Moderate vegetation
        'green',    # Dense vegetation
        'darkgreen' # Very dense vegetation
    ]
}

m.addLayer(HyderabadSAVI_1989, SAVI_viz, 'SAVI_1989')
m

m.setCenter(78.486671, 17.385044, 10)

out_dir = 'Downloads'  # Using a directory that's accessible in my environment
filename_html = os.path.join(out_dir, 'NDVI_SAVI_NDWI_map.html')

# Create the directory if it doesn't exist
if not os.path.exists(out_dir):
    os.makedirs(out_dir)
m.save('/content/Downloads/NDVI_SAVI_NDWI_map.html')

from google.colab import files
files.download('/content/Downloads/NDVI_SAVI_NDWI_map.html')
